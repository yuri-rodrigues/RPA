<Activity mc:Ignorable="sap sap2010" x:Class="wf_AbrirSiteWpp" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="arg_in_strTelefone" Type="InArgument(x:String)" />
    <x:Property Name="arg_in_strNome" Type="InArgument(x:String)" />
    <x:Property Name="arg_out_booAchouErroNoSite" Type="OutArgument(x:Boolean)" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1493,6795</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>wf_AbrirSiteWpp_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="23">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>UiPath.Excel</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="22">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>UiPath.CV</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <Sequence sap2010:Annotation.AnnotationText="Esse WorkFlow tenta carregar a página do contado para enviar a mensagem. Ele verifica se encontra os seguintes erros:&#xA;&#xA;1 - Erro de conexão com o whatsapp&#xA;&#xA;2 - Erro com a internet (o site não abre, então ele fecha e tenta o proximo contato da planilha)&#xA;&#xA;3 - Número inválido. Se o numero por algum motivo não existir, ele fecha e tenta o próximo da planilha.&#xA;&#xA;* Caso não encontre nenhum desses erros, prossegue para o envio da mensagem" DisplayName="Sequence - Abrir site do WhatsApp e Realizar o envio da mensagem" sap:VirtualizedContainerService.HintSize="957,6630" sap2010:WorkflowViewState.IdRef="Sequence_2">
    <Sequence.Variables>
      <Variable x:TypeArguments="x:String" Name="var_strCamihoWhatsWeb" />
      <Variable x:TypeArguments="x:Boolean" Name="var_booCelularNaoConectado" />
      <Variable x:TypeArguments="x:Int32" Default="0" Name="var_intContador" />
      <Variable x:TypeArguments="sd:DataTable" Name="var_dtLogEnvios" />
      <Variable x:TypeArguments="x:Boolean" Name="var_booAchouBotaoIniciarConversa" />
      <Variable x:TypeArguments="x:Boolean" Name="var_booCarregouTelaDeMensagem" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <x:Boolean x:Key="IsPinned">False</x:Boolean>
        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <ui:BuildDataTable DataTable="[var_dtLogEnvios]" DisplayName="Build Data Table" sap:VirtualizedContainerService.HintSize="915,59" sap2010:WorkflowViewState.IdRef="BuildDataTable_1" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;DataTentativa&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;100&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Status&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Nome&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Telefone&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Mensagem&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;" />
    <Assign sap:VirtualizedContainerService.HintSize="915,60" sap2010:WorkflowViewState.IdRef="Assign_1">
      <Assign.To>
        <OutArgument x:TypeArguments="x:String">[var_strCamihoWhatsWeb]</OutArgument>
      </Assign.To>
      <Assign.Value>
        <InArgument x:TypeArguments="x:String">https://api.whatsapp.com/send?phone=+55</InArgument>
      </Assign.Value>
    </Assign>
    <Sequence sap:VirtualizedContainerService.HintSize="915,6192" sap2010:WorkflowViewState.IdRef="Sequence_7">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <ui:OpenBrowser CommunicationMethod="{x:Null}" Hidden="{x:Null}" NewSession="{x:Null}" Private="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Open Browser - WhatsApp Web" sap:VirtualizedContainerService.HintSize="873,6100" sap2010:WorkflowViewState.IdRef="OpenBrowser_1" Url="[var_strCamihoWhatsWeb+arg_in_strTelefone]">
        <ui:OpenBrowser.Body>
          <ActivityAction x:TypeArguments="x:Object">
            <ActivityAction.Argument>
              <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
            </ActivityAction.Argument>
            <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="839,5999" sap2010:WorkflowViewState.IdRef="Sequence_6">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ui:MaximizeWindow Window="{x:Null}" DisplayName="Maximize Window" sap:VirtualizedContainerService.HintSize="797,22" sap2010:WorkflowViewState.IdRef="MaximizeWindow_1" />
              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="797,91" sap2010:WorkflowViewState.IdRef="LogMessage_7" Level="Info" Message="[&quot;Abrindo a página do contato e procurando por possíveis erros.&quot;]" />
              <ui:InterruptibleDoWhile DisplayName="Do While" sap:VirtualizedContainerService.HintSize="797,463" sap2010:WorkflowViewState.IdRef="InterruptibleDoWhile_1">
                <ui:InterruptibleDoWhile.Body>
                  <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="376,298" sap2010:WorkflowViewState.IdRef="Sequence_8">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:UiElementExists DisplayName="Element Exists - Procurando Erro" Exists="[var_booCelularNaoConectado]" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="UiElementExists_1">
                      <ui:UiElementExists.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="25c44bb5-88a7-4c79-85cb-25394c6d356a" InformativeScreenshot="1313bf6182fe654be9c9715ff3a8ac88" Selector="&lt;html app='chrome.exe' title='WhatsApp' /&gt;&#xA;&lt;webctrl aaname='Tentando conectar ao celular' parentid='app' tag='DIV' innertext='Tentando conectar ao celular' /&gt;&#xA;" TimeoutMS="5000">
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:UiElementExists.Target>
                    </ui:UiElementExists>
                    <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_7">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:Int32">[var_intContador]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:Int32">[var_intContador + 1]</InArgument>
                      </Assign.Value>
                    </Assign>
                  </Sequence>
                </ui:InterruptibleDoWhile.Body>
                <ui:InterruptibleDoWhile.Condition>
                  <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="var_booCelularNaoConectado = True and var_intContador &lt; 3" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_1" />
                </ui:InterruptibleDoWhile.Condition>
              </ui:InterruptibleDoWhile>
              <If Condition="[var_intContador = 3]" DisplayName="If - Se não carregar o whatsapp, fecha a página e insere log na planilha" sap:VirtualizedContainerService.HintSize="797,709" sap2010:WorkflowViewState.IdRef="If_1">
                <If.Then>
                  <Sequence DisplayName="Sequence - Insere Log" sap:VirtualizedContainerService.HintSize="376,562" sap2010:WorkflowViewState.IdRef="Sequence_9">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_2" Level="Error" Message="[&quot;Erro ao carregar WhatsApp. Preenchendo Log na planilha.&quot;]" />
                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Now.ToString (&quot;dd/MM/yyyy HH:mm&quot;), &quot;Erro&quot;, arg_in_strNome, arg_in_strTelefone, &quot;Não foi possível abrir o WhatsApp Web. Verifique a conexão e tente novamente&quot;}]" DataTable="[var_dtLogEnvios]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="AddDataRow_1" />
                    <ui:AppendRange DataTable="[var_dtLogEnvios]" DisplayName="Append Range" sap:VirtualizedContainerService.HintSize="334,115" sap2010:WorkflowViewState.IdRef="AppendRange_1" SheetName="Planilha1" WorkbookPath="Data\Log de envios.xlsx" />
                    <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_5">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:Boolean">[arg_out_booAchouErroNoSite]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                      </Assign.Value>
                    </Assign>
                    <ui:KillProcess ContinueOnError="{x:Null}" Process="{x:Null}" DisplayName="Kill Process" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="KillProcess_1" ProcessName="chrome" />
                  </Sequence>
                </If.Then>
                <If.Else>
                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_8" Level="Trace" Message="[&quot;Passou verificação 1&quot;]" />
                </If.Else>
              </If>
              <Assign sap:VirtualizedContainerService.HintSize="797,60" sap2010:WorkflowViewState.IdRef="Assign_4">
                <Assign.To>
                  <OutArgument x:TypeArguments="x:Int32">[var_intContador]</OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="x:Int32">0</InArgument>
                </Assign.Value>
              </Assign>
              <ui:InterruptibleDoWhile DisplayName="Do While" sap:VirtualizedContainerService.HintSize="797,463" sap2010:WorkflowViewState.IdRef="InterruptibleDoWhile_2">
                <ui:InterruptibleDoWhile.Body>
                  <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="376,298" sap2010:WorkflowViewState.IdRef="Sequence_10">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:UiElementExists DisplayName="Procurando botão iniciar conversa" Exists="[var_booAchouBotaoIniciarConversa]" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="UiElementExists_2">
                      <ui:UiElementExists.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="5140a91a-e5e8-46c9-843c-38ba970ff0b8" InformativeScreenshot="f2b874b87acdf974288219033839f9d7" Selector="&lt;html app='chrome.exe' title='Compartilhe no WhatsApp' /&gt;&#xA;&lt;webctrl id='action-button' tag='A' aaname='Iniciar conversa' innertext='Iniciar conversa' /&gt;&#xA;" TimeoutMS="5000">
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:UiElementExists.Target>
                    </ui:UiElementExists>
                    <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_8">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:Int32">[var_intContador]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:Int32">[var_intContador + 1]</InArgument>
                      </Assign.Value>
                    </Assign>
                  </Sequence>
                </ui:InterruptibleDoWhile.Body>
                <ui:InterruptibleDoWhile.Condition>
                  <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="var_booAchouBotaoIniciarConversa = false and var_intContador &lt; 3" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_2" />
                </ui:InterruptibleDoWhile.Condition>
              </ui:InterruptibleDoWhile>
              <If Condition="[var_intContador = 3]" DisplayName="If - Se não carregar a página ele encerra o navegador" sap:VirtualizedContainerService.HintSize="797,709" sap2010:WorkflowViewState.IdRef="If_3">
                <If.Then>
                  <Sequence DisplayName="Sequence - Insere Log" sap:VirtualizedContainerService.HintSize="376,562" sap2010:WorkflowViewState.IdRef="Sequence_11">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_3" Level="Error" Message="[&quot;Erro ao carregar WhatsApp. Preenchendo Log na planilha.&quot;]" />
                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Now.ToString (&quot;dd/MM/yyyy HH:mm&quot;), &quot;Erro&quot;, arg_in_strNome, arg_in_strTelefone, &quot;Não foi possível abrir o WhatsApp Web. Verifique a conexão e tente novamente&quot;}]" DataTable="[var_dtLogEnvios]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="AddDataRow_2" />
                    <ui:AppendRange DataTable="[var_dtLogEnvios]" DisplayName="Append Range" sap:VirtualizedContainerService.HintSize="334,115" sap2010:WorkflowViewState.IdRef="AppendRange_2" SheetName="Planilha1" WorkbookPath="Data\Log de envios.xlsx" />
                    <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_6">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:Boolean">[arg_out_booAchouErroNoSite]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                      </Assign.Value>
                    </Assign>
                    <ui:KillProcess ContinueOnError="{x:Null}" Process="{x:Null}" DisplayName="Kill Process" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="KillProcess_2" ProcessName="chrome" />
                  </Sequence>
                </If.Then>
                <If.Else>
                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_9" Level="Trace" Message="[&quot;Passou verificação 2&quot;]" />
                </If.Else>
              </If>
              <Assign sap:VirtualizedContainerService.HintSize="797,60" sap2010:WorkflowViewState.IdRef="Assign_9">
                <Assign.To>
                  <OutArgument x:TypeArguments="x:Int32">[var_intContador]</OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="x:Int32">0</InArgument>
                </Assign.Value>
              </Assign>
              <Sequence DisplayName="Sequence - Abrir conversa" sap:VirtualizedContainerService.HintSize="797,1658" sap2010:WorkflowViewState.IdRef="Sequence_12">
                <Sequence.Variables>
                  <Variable x:TypeArguments="x:Boolean" Name="var_booNumeroErrado" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:Click AlterIfDisabled="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" SimulateClick="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click - Iniciar Conversa" sap:VirtualizedContainerService.HintSize="755,106" sap2010:WorkflowViewState.IdRef="Click_1" KeyModifiers="None" MouseButton="BTN_LEFT">
                  <ui:Click.CursorPosition>
                    <ui:CursorPosition Position="Center">
                      <ui:CursorPosition.OffsetX>
                        <InArgument x:TypeArguments="x:Int32" />
                      </ui:CursorPosition.OffsetX>
                      <ui:CursorPosition.OffsetY>
                        <InArgument x:TypeArguments="x:Int32" />
                      </ui:CursorPosition.OffsetY>
                    </ui:CursorPosition>
                  </ui:Click.CursorPosition>
                  <ui:Click.Target>
                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="d7dd1511-9e20-42ba-887a-2cce39a52588" InformativeScreenshot="f2b874b87acdf974288219033839f9d7" Selector="&lt;html app='chrome.exe' title='Compartilhe no WhatsApp' /&gt;&lt;webctrl id='action-button' tag='A' aaname='Iniciar conversa' innertext='Iniciar conversa' /&gt;">
                      <ui:Target.TimeoutMS>
                        <InArgument x:TypeArguments="x:Int32" />
                      </ui:Target.TimeoutMS>
                      <ui:Target.WaitForReady>
                        <InArgument x:TypeArguments="ui:WaitForReady" />
                      </ui:Target.WaitForReady>
                    </ui:Target>
                  </ui:Click.Target>
                </ui:Click>
                <Delay mva:VisualBasic.Settings="{x:Null}" DisplayName="Delay 1 second" Duration="00:00:01" sap:VirtualizedContainerService.HintSize="755,22" sap2010:WorkflowViewState.IdRef="Delay_1">
                  <TextExpression.Namespaces>
                    <sco:Collection x:TypeArguments="x:String">
                      <x:String>System.Activities</x:String>
                      <x:String>System.Activities.Statements</x:String>
                      <x:String>System.Activities.Expressions</x:String>
                      <x:String>System.Activities.Validation</x:String>
                      <x:String>System.Activities.XamlIntegration</x:String>
                      <x:String>Microsoft.VisualBasic.Activities</x:String>
                      <x:String>System</x:String>
                      <x:String>System.Collections.Generic</x:String>
                      <x:String>System.Data</x:String>
                      <x:String>System.Diagnostics</x:String>
                      <x:String>System.IO</x:String>
                      <x:String>System.Linq</x:String>
                      <x:String>System.Management.Automation</x:String>
                      <x:String>System.Net.Mail</x:String>
                      <x:String>System.Xml</x:String>
                      <x:String>System.Xml.Linq</x:String>
                      <x:String>UiPath.Library</x:String>
                      <x:String>System.Windows.Markup</x:String>
                    </sco:Collection>
                  </TextExpression.Namespaces>
                  <TextExpression.References>
                    <sco:Collection x:TypeArguments="AssemblyReference">
                      <AssemblyReference>System.Activities</AssemblyReference>
                      <AssemblyReference>mscorlib</AssemblyReference>
                      <AssemblyReference>System.Data</AssemblyReference>
                      <AssemblyReference>System</AssemblyReference>
                      <AssemblyReference>System.Core</AssemblyReference>
                      <AssemblyReference>System.Management.Automation</AssemblyReference>
                      <AssemblyReference>System.Xml</AssemblyReference>
                      <AssemblyReference>System.Xml.Linq</AssemblyReference>
                      <AssemblyReference>UiPath.Library</AssemblyReference>
                      <AssemblyReference>PresentationFramework</AssemblyReference>
                      <AssemblyReference>WindowsBase</AssemblyReference>
                      <AssemblyReference>PresentationCore</AssemblyReference>
                      <AssemblyReference>System.Xaml</AssemblyReference>
                    </sco:Collection>
                  </TextExpression.References>
                  <sap2010:WorkflowViewState.ViewStateManager>
                    <sap2010:ViewStateManager>
                      <sap2010:ViewStateData sap:VirtualizedContainerService.HintSize="200,22" Id="Delay_1" />
                    </sap2010:ViewStateManager>
                  </sap2010:WorkflowViewState.ViewStateManager>
                </Delay>
                <ui:Click AlterIfDisabled="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" SimulateClick="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click - Use WhatsApp Web" sap:VirtualizedContainerService.HintSize="755,106" sap2010:WorkflowViewState.IdRef="Click_2" KeyModifiers="None" MouseButton="BTN_LEFT">
                  <ui:Click.CursorPosition>
                    <ui:CursorPosition Position="Center">
                      <ui:CursorPosition.OffsetX>
                        <InArgument x:TypeArguments="x:Int32" />
                      </ui:CursorPosition.OffsetX>
                      <ui:CursorPosition.OffsetY>
                        <InArgument x:TypeArguments="x:Int32" />
                      </ui:CursorPosition.OffsetY>
                    </ui:CursorPosition>
                  </ui:Click.CursorPosition>
                  <ui:Click.Target>
                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="f562d740-5b9d-4c69-98d7-26e575b30778" InformativeScreenshot="3e96620fc4fa23925647325c653bf8a3" Selector="&lt;html app='chrome.exe' title='Compartilhe no WhatsApp' /&gt;&lt;webctrl aaname='use o WhatsApp Web' parentid='fallback_block' tag='A' innertext='use o WhatsApp Web' /&gt;">
                      <ui:Target.TimeoutMS>
                        <InArgument x:TypeArguments="x:Int32" />
                      </ui:Target.TimeoutMS>
                      <ui:Target.WaitForReady>
                        <InArgument x:TypeArguments="ui:WaitForReady" />
                      </ui:Target.WaitForReady>
                    </ui:Target>
                  </ui:Click.Target>
                </ui:Click>
                <ui:InterruptibleDoWhile DisplayName="Do While" sap:VirtualizedContainerService.HintSize="755,463" sap2010:WorkflowViewState.IdRef="InterruptibleDoWhile_3">
                  <ui:InterruptibleDoWhile.Body>
                    <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="376,298" sap2010:WorkflowViewState.IdRef="Sequence_13">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:UiElementExists DisplayName="Element Exists - Procurar erro de numero" Exists="[var_booNumeroErrado]" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="UiElementExists_3">
                        <ui:UiElementExists.Target>
                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="71a4cdf1-0f43-40aa-a7ea-bec12992d475" InformativeScreenshot="f86c938843395fe921b90515d0eea818" Selector="&lt;html app='chrome.exe' /&gt;&lt;webctrl isleaf='1' parentid='app' tag='DIV' innertext='Phone number shared via url is invalid.' aaname='Phone number shared via url is invalid.' /&gt;" TimeoutMS="5000">
                            <ui:Target.WaitForReady>
                              <InArgument x:TypeArguments="ui:WaitForReady" />
                            </ui:Target.WaitForReady>
                          </ui:Target>
                        </ui:UiElementExists.Target>
                      </ui:UiElementExists>
                      <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_10">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:Int32">[var_intContador]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:Int32">[var_intContador + 1]</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                  </ui:InterruptibleDoWhile.Body>
                  <ui:InterruptibleDoWhile.Condition>
                    <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="var_booNumeroErrado = False and var_intContador &lt;2" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_4" />
                  </ui:InterruptibleDoWhile.Condition>
                </ui:InterruptibleDoWhile>
                <If Condition="[var_booNumeroErrado = True]" DisplayName="If - Se o numero estiver errado, Fecha pagina e insere log" sap:VirtualizedContainerService.HintSize="755,709" sap2010:WorkflowViewState.IdRef="If_4">
                  <If.Then>
                    <Sequence DisplayName="Sequence - Insere Log" sap:VirtualizedContainerService.HintSize="376,562" sap2010:WorkflowViewState.IdRef="Sequence_14">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_4" Level="Error" Message="[&quot;Erro ao carregar WhatsApp. Preenchendo Log na planilha.&quot;]" />
                      <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Now.ToString (&quot;dd/MM/yyyy HH:mm&quot;), &quot;Erro&quot;, arg_in_strNome, arg_in_strTelefone, &quot;Número inválido. Verificar na planilha&quot;}]" DataTable="[var_dtLogEnvios]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="AddDataRow_3" />
                      <ui:AppendRange DataTable="[var_dtLogEnvios]" DisplayName="Append Range" sap:VirtualizedContainerService.HintSize="334,115" sap2010:WorkflowViewState.IdRef="AppendRange_3" SheetName="Planilha1" WorkbookPath="Data\Log de envios.xlsx" />
                      <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_11">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:Boolean">[arg_out_booAchouErroNoSite]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:KillProcess ContinueOnError="{x:Null}" Process="{x:Null}" DisplayName="Kill Process" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="KillProcess_3" ProcessName="chrome" />
                    </Sequence>
                  </If.Then>
                  <If.Else>
                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_10" Level="Trace" Message="[&quot;Passou verificação 3&quot;]" />
                  </If.Else>
                </If>
              </Sequence>
              <Assign sap:VirtualizedContainerService.HintSize="797,60" sap2010:WorkflowViewState.IdRef="Assign_12">
                <Assign.To>
                  <OutArgument x:TypeArguments="x:Int32">[var_intContador]</OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="x:Int32">0</InArgument>
                </Assign.Value>
              </Assign>
              <ui:InterruptibleDoWhile DisplayName="Do While" sap:VirtualizedContainerService.HintSize="797,463" sap2010:WorkflowViewState.IdRef="InterruptibleDoWhile_4">
                <ui:InterruptibleDoWhile.Body>
                  <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="376,298" sap2010:WorkflowViewState.IdRef="Sequence_15">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:ImageFound DisplayName="Image Exists 'chrome.exe  WhatsApp'" Found="[var_booCarregouTelaDeMensagem]" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="ImageFound_1">
                      <ui:ImageFound.Image>
                        <ui:ImageTarget Image="{x:Null}" Accuracy="0.8" Profile="Basic" TargetImageBase64="iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAYAAACoPemuAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAI8SURBVFhH7ZYtk8IwEIbv/zsMGDBgwIBBoUChMGDAoFCo/oPcPJl5b5bctknauZkTFc8Ussnm3Y80/WqaJvxHRmG1jMJqGYXVMgqrZZCw9/sdLpdL2O12YbPZhMViEZ9wOBzC7XZz15XQSxiC9vt9mEwmH0yn019js9ksivf8dFEt7Hq9xs3YdD6fh/P5HF6vlzuPrEnsarUKz+fz17w2qoQROZuwGYK8OSk2uwRUKq5Y2P1+/xFVE7lQUKXiioQRtcrXR5SQOMrq2S1Fwk6nU3TI07PXQN/hK9cKWWHKFo3O79R2PB4jdhzU/GmGWUM74NOOp2SFKf1etogaG9CD1qbTuN1uP8ZBWUN8ahNZYTpRXm9pA7DCdVAAgXaNteM7tYmssPV6HZ14NmUTUuHKWNvm2PDt2SArjN7yohaU0ysJQsli2pcCYV2nMysMB9yBnm0IuYB7lZIs6aLmRPL/8Xh8wBg2Ssnc9PAMLqWE2fuQ0rEhmwG/mZeCcARit+XG12BhOMYJjW7HKQUbdt0ECCBracnkk6cdt2SFKTrKYcfJAOPAy1LfYYLGlj0NarlcxnHvq0RkhQEp9zawr4s22tZ4L15LkTBlzfsywEafSTyQEcqcZoS1+hjoyhYUCQNFWvvBJ1ij8qZZ9CgWBmQBx0Rd4lzQ5MpU+tpoo0oYIEjXDS9eNvUyyBg25jCXNTXBVAsD+kPZK8Hrtxy9hAnuQbLAxjQ/TQ/8Zgxb212ZY5Cwv2QUVssorI4mfAOIn69SsELYFAAAAABJRU5ErkJggg==" />
                      </ui:ImageFound.Image>
                      <ui:ImageFound.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" Id="0d277ffa-6cab-4e92-bcf7-9f6a9a1e2c0d">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:ImageFound.Target>
                    </ui:ImageFound>
                    <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_13">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:Int32">[var_intContador]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:Int32">[var_intContador + 1]</InArgument>
                      </Assign.Value>
                    </Assign>
                  </Sequence>
                </ui:InterruptibleDoWhile.Body>
                <ui:InterruptibleDoWhile.Condition>
                  <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="var_booCarregouTelaDeMensagem = False and var_intContador &lt;3" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_5" />
                </ui:InterruptibleDoWhile.Condition>
              </ui:InterruptibleDoWhile>
              <If Condition="[var_intContador = 3]" DisplayName="If - Se não carregar tela da mensagem fecha o navegador" sap:VirtualizedContainerService.HintSize="797,709" sap2010:WorkflowViewState.IdRef="If_5">
                <If.Then>
                  <Sequence DisplayName="Sequence - Insere Log" sap:VirtualizedContainerService.HintSize="376,562" sap2010:WorkflowViewState.IdRef="Sequence_16">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_5" Level="Error" Message="[&quot;Erro ao carregar WhatsApp. Preenchendo Log na planilha.&quot;]" />
                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{Now.ToString (&quot;dd/MM/yyyy HH:mm&quot;), &quot;Erro&quot;, arg_in_strNome, arg_in_strTelefone, &quot;Não foi possível abrir o WhatsApp Web. Verifique a conexão e tente novamente&quot;}]" DataTable="[var_dtLogEnvios]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="AddDataRow_4" />
                    <ui:AppendRange DataTable="[var_dtLogEnvios]" DisplayName="Append Range" sap:VirtualizedContainerService.HintSize="334,115" sap2010:WorkflowViewState.IdRef="AppendRange_4" SheetName="Planilha1" WorkbookPath="Data\Log de envios.xlsx" />
                    <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_14">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:Boolean">[arg_out_booAchouErroNoSite]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                      </Assign.Value>
                    </Assign>
                    <ui:KillProcess ContinueOnError="{x:Null}" Process="{x:Null}" DisplayName="Kill Process" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="KillProcess_4" ProcessName="chrome" />
                  </Sequence>
                </If.Then>
                <If.Else>
                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_6" Level="Info" Message="[&quot;Sucesso ao carregar contato. Enviar a mensagem:.&quot;]" />
                </If.Else>
              </If>
            </Sequence>
          </ActivityAction>
        </ui:OpenBrowser.Body>
      </ui:OpenBrowser>
    </Sequence>
  </Sequence>
</Activity>